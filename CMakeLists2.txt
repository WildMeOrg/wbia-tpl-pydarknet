# Define library targets

file(GLOB SOURCE_FILES "src/*.c")
file(GLOB HEADER_FILES "src/*.h")
file(GLOB CUDA_SOURCE_FILES "src/*.cu")


if (CUDA)
  cuda_add_library(pydarknet.gpu SHARED
    ${SOURCE_FILES}
    ${HEADER_FILES}
    ${CUDA_SOURCE_FILES}
  )

  target_link_libraries(pydarknet.gpu
    ${OpenCV_LIBS}
    ${CMAKE_THREAD_LIBS_INIT}
    ${CUDA_LIBRARIES}
    ${CUDA_CUBLAS_LIBRARIES}
    ${CUDA_curand_LIBRARY}
  )
  set(install_target pydarknet.gpu)
else ()
  add_library(pydarknet.cpu SHARED
    ${SOURCE_FILES}
  )

  target_link_libraries(pydarknet.cpu
    ${OpenCV_LIBS}
    ${CMAKE_THREAD_LIBS_INIT}
    ${CUDA_LIBRARIES}
    ${CUDA_CUBLAS_LIBRARIES}
    ${CUDA_curand_LIBRARY}
  )
  set(install_target pydarknet.cpu)
endif ()